---
title: "Get Started"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{Get Started}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>"
)
```

```{r setup}
# library(ospsuite.qualificationplaneditor)
```


The OSPSuite.QualificationPlanEditor package is designed to help you convert qualification plans from/into Excel format for easier editing.

The package provides functionality to parse project snapshots, extract simulation data, and generate Excel workbooks with structured data sheets that can be edited and converted back to qualification plans.

## Example

Here is a basic example showing how to include an updated project snapshot in your qualification plan:

``` r
## Load the ospsuite.qualificationplaneditor package
library(ospsuite.qualificationplaneditor)
ospPath <- "https://raw.githubusercontent.com/Open-Systems-Pharmacology"
excelQualification <- "Updated-Qualification.xlsx"

# List your updated snapshot projects
snapshotPaths <- list(
  "Compound A" = file.path(ospPath, "A-Model/vX.X/A-Model.json"),
  "Compound B" = file.path(ospPath, "B-Model/vX.X/B-Model.json"),
  "A-B-DDI" = file.path(ospPath, "A-B-DDI/vX.X/A-B-DDI.json")
)

# List your updated observed datasets
observedDataPaths <- list("DDI Ratios" = list(
    Path = file.path(ospPath, "Database-for-observed-data/vX.X/DDI.csv"),
    Type = "DDIRatio"
    ))

# Initial qualification plan
qualificationPlan <- file.path(ospPath, "A-Model/vY.Y/Qualification/qualification_plan.json")

# qualification plan converted to Excel
toExcelEditor(
  fileName = excelQualification,
  snapshotPaths = snapshotPaths, 
  observedDataPaths = observedDataPaths,
  qualificationPlan = qualificationPlan
)

# Tip: this will open Excel (or Libre office) with the created Excel workbook
utils::browseURL(excelQualification)

```

## Automatically Get Latest Released Paths

The `getLatestReleasedPaths()` function helps you automatically fetch the latest released versions of projects and observed data from your qualification plan:

``` r
# Get latest released paths from a qualification plan
latestPaths <- getLatestReleasedPaths(
  qualificationPlan = "path/to/qualification_plan.json",
  includePreReleases = FALSE,
  returnUpdatedOnly = TRUE
)

# Access the updated project and observed data paths
latestProjectPaths <- latestPaths$projects
latestObservedDataPaths <- latestPaths$observedData

# You can also ignore specific projects or observed data
latestPaths <- getLatestReleasedPaths(
  qualificationPlan = "path/to/qualification_plan.json",
  projectsToIgnore = c("ProjectA", "ProjectB"),
  observedDataToIgnore = c("ObsData1")
)

# Get all paths (not just updated ones)
allPaths <- getLatestReleasedPaths(
  qualificationPlan = "path/to/qualification_plan.json",
  returnUpdatedOnly = FALSE
)
```

