---
title: "Excel Template"
output: 
  rmarkdown::html_vignette:
    tabset: true
vignette: >
  %\VignetteIndexEntry{Excel Template}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>"
)
```

```{r setup}
library(ospsuite.qualificationplaneditor)
```

## Context

This article describes the Excel template to be edited to create or update a qualification plan.

## Color convention

In the Excel template, many cells are filled with colors that follows the convention defined below:

### Header

Two background colors are used for headers:

- <span style="background-color:#ADD8E6;">Blue</span>: data was found and corresponding Excel sheet was filled with project snapshots, observed datasets and/or qualification plan information
- <span style="background-color:#ffff00;">Yellow</span>: no data was found to fill corresponding sheet

### Table rows

- <span style="background-color:#A3FFA3;">Green</span>: project or observed dataset is not present in current qualification plan and assumed as to be **Added** to the qualification
- <span style="background-color:#DDDDDD;">Grey</span>: project or observed dataset is present in current qualification plan and<br>either not present in the list of added snapshots/observed datasets<br>or present but version/path is the same as in the qualification plan
- <span style="background-color:#FFFFBF;">Yellow</span>: project or observed dataset is present in current qualification plan and present in the list of added snapshots/observed datasets<br>while version/path is **Changed** between them

## How to edit Excel sheets

### MetaInfo

Defines the version of the Qualification Plan Schema. The value should be formatted as `vX.Y`.

You can check version tags on GitHub in  [QualificationPlan](https://github.com/Open-Systems-Pharmacology/QualificationPlan/tags) repository.

### Projects

List project identifiers (`Id`) and their paths.
The background uses the color convention defined above.

This Excel sheet should not be edited.

### Simulations_Outputs

List simulations and outputs for each project.
The background uses the color convention defined above.

This Excel sheet should not be edited.

### Simulations_ObsData

List simulations and observed data for each project.
The background uses the color convention defined above.

This Excel sheet should not be edited.

### ObsData

List Observed dataset identifiers (`Id`),  their paths and Type.
The background uses the color convention defined above.

You can edit the Type of Observed data.

### BB

List Building Blocks potential inheritance.
Fill the **Parent-Project** column for a project to inherit the corresponding building block from a parent project.

An Excel data validation is set up to select from available projects.

### SimParam

List simulated parameters potential inheritance.
Fill the **Parent Project**, **Parent Simulation**, **Path** and **Target Simulation** columns for a project to inherit the corresponding simulated parameters from a parent project.

Excel data validations are set up to select from available projects and simulations.

### All_Plots

List all plots evaluations for each project and simulation.

Fill the **Section Reference** column to include the evaluation in the corresponding section.
Excel data validations are set up to select from available sections.

### CT_Plots and CT_Mapping

Define and list Comparison Time Profile (CT) plots.

Excel data validations are set up to select from available sections, projects, simulations, observed data, etc.

### GOF_Plots and GOF_Mapping

Define and list Goodness of Fit (GOF) plots.

Excel data validations are set up to select from available sections, projects, simulations, observed data, etc.

### DDIRatio_Plots and DDIRatio_Mapping

Define and list DDI Ratio plots.

Excel data validations are set up to select from available sections, projects, simulations, observed data, etc.

### PKRatio_Plots and PKRatio_Mapping

Define and list PK Ratio plots.

Excel data validations are set up to select from available sections, projects, simulations, observed data, etc.

### Sections

Define and list Qualification Report sections.

Fill **Section Reference** tag to identify a section. 
If section is a sub-section, fill the **Parent Section** column, Excel data validations are set up to select from available sections.

### Intro

Define the path of the markdown file used as introduction of your qualification report.

### Inputs

Fill the **Project**, **BB-Type**, **BB-Name** and **Section Reference** to include the Building Block definitions into the corresponding section of your qualification report.
Excel data validations are set up to select from available building blocks and sections.

### GlobalPlotSettings

Define the global settings of the exported figures including the size of the figure in pixels.

### GlobalAxesSettings

Define the global axes settings of the exported figures corresponding to dimensions, units and scales of the plots.

### Lookup

Look up table defining allowed values for qualification plan properties.

